test_person_site_ids:
  model: ghii_omop.person
  inputs:
    ohdl.person:
      format: csv
      rows: |
        person_id,site_id,gender,birthdate,voided
        1,123,,,0
        1,654,,,0
      columns:
        gender: varchar(50)
        birthdate: datetime
        voided: int
    ohdl.patient:
      format: csv
      rows: |
        patient_id,site_id
        1,123
        1,654
  outputs:
    query:
      rows:
        - person_id: 12381
          person_source_value: 123-1
          race_concept_id: 0
          ethnicity_concept_id: 0
          location_id: 123
        - person_id: 65481
          person_source_value: 654-1
          race_concept_id: 0
          ethnicity_concept_id: 0
          location_id: 654

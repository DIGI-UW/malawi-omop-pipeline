test_person_birthdates:
  model: ghii_omop.person
  inputs:
    ohdl.person:
      format: csv
      rows: |
        person_id,site_id,gender,birthdate,birthdate_estimated,voided
        1,123,M,2020-04-01,0,0
        2,123,M,1990-12-31,0,0
        3,123,M,1958-01-01,0,0
        4,123,M,2012-02-29,0,0
      columns:
        gender: varchar(50)
        birthdate: datetime
        birthdate_estimated: int
        voided: int
    ohdl.patient:
      format: csv
      rows: |
        patient_id,site_id
        1,123
        2,123
        3,123
        4,123
  outputs:
    query:
      rows:
        - person_id: 12381
          gender_concept_id: 8507
          year_of_birth: 2020
          month_of_birth: 4
          day_of_birth: 1
          birth_datetime: 2020-04-01
          race_concept_id: 0
          ethnicity_concept_id: 0
          location_id: 123
          person_source_value: 123-1
          gender_source_value: M
        - person_id: 12382
          gender_concept_id: 8507
          year_of_birth: 1990
          month_of_birth: 12
          day_of_birth: 31
          birth_datetime: 1990-12-31
          race_concept_id: 0
          ethnicity_concept_id: 0
          location_id: 123
          person_source_value: 123-2
          gender_source_value: M
        - person_id: 12383
          gender_concept_id: 8507
          year_of_birth: 1958
          month_of_birth: 1
          day_of_birth: 1
          birth_datetime: 1958-01-01
          race_concept_id: 0
          ethnicity_concept_id: 0
          location_id: 123
          person_source_value: 123-3
          gender_source_value: M
        - person_id: 12384
          gender_concept_id: 8507
          year_of_birth: 2012
          month_of_birth: 2
          day_of_birth: 29
          birth_datetime: 2012-02-29
          race_concept_id: 0
          ethnicity_concept_id: 0
          location_id: 123
          person_source_value: 123-4
          gender_source_value: M

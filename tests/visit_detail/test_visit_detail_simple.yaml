test_visit_detail_simple:
  model: ghii_omop.visit_detail
  inputs:
    ghii_omop.visit_occurrence:
      format: csv
      rows: |
        visit_occurrence_id,person_id,visit_start_datetime,visit_end_datetime
        12381,12381,2024-01-01 12:00:00,2024-01-01 12:00:00
      columns:
        visit_start_datetime: datetime
        visit_end_datetime: datetime
    ohdl.encounter:
      format: csv
      rows: |
        encounter_id,site_id,patient_id,encounter_type,encounter_datetime,voided
        1,123,1,1,2024-01-01 12:00:00,0
      columns:
        encounter_datetime: datetime
    ohdl.encounter_type:
      format: csv
      rows: |
        encounter_type_id,name
        1,Encounter
  outputs:
    query:
      - visit_detail_id: 12381
        person_id: 12381
        visit_detail_concept_id: 9202
        visit_detail_start_date: 2024-01-01
        visit_detail_start_datetime: 2024-01-01 12:00:00
        visit_detail_end_date: 2024-01-01
        visit_detail_end_datetime: 2024-01-01 12:00:00
        visit_detail_type_concept_id: 32817
        visit_detail_source_value: Encounter
        visit_occurrence_id: 12381

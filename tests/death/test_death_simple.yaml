test_death_simple:
  model: ghii_omop.death
  inputs:
    ohdl.person:
      format: csv
      rows: |
        person_id,site_id,dead,death_date,voided
        1,123,0,,0
        2,123,1,2025-02-15 00:00:00,0
        3,123,0,2025-02-15 00:00:00,0
        4,123,0,,1
        5,123,0,,0
        6,123,0,,0
      columns:
        death_date: datetime
    ohdl.patient:
      format: csv
      rows: |
        patient_id,site_id,voided
        1,123,0
        2,123,0
        3,123,0
        4,123,0
        5,123,1
        6,123,0
    ohdl.patient_program:
      format: csv
      rows: |
        patient_program_id,program_id,patient_id,site_id,voided
        1,1,1,123,0
        2,1,2,123,0
        3,1,3,123,0
        4,1,4,123,0
        5,1,5,123,0
        6,2,6,123,0
    ohdl.patient_state:
      format: csv
      rows: |
        patient_program_id,site_id,voided,state,start_date
        1,123,0,1,2025-02-15 00:00:00
        2,123,0,1,2025-02-15 00:00:00
        3,123,0,2,2025-02-15 00:00:00
        4,123,0,1,2025-01-01 00:00:00
        5,123,0,1,2025-01-01 00:00:00
        6,123,0,1,2025-01-01 00:00:00
    ohdl.program_workflow_state:
      format: csv
      rows: |
        program_workflow_state_id,concept_id
        1,1742
        2,1000
  outputs:
    query:
      - person_id: 12381
        death_date: 2025-02-15
        death_datetime: 2025-02-15 00:00:00
        death_type_concept_id: 32817
      - person_id: 12382
        death_date: 2025-02-15
        death_datetime: 2025-02-15 00:00:00
        death_type_concept_id: 32817
      - person_id: 12383
        death_date: 2025-02-15
        death_datetime: 2025-02-15 00:00:00
        death_type_concept_id: 32817
